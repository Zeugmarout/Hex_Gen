<!DOCTYPE html>
<html lang="en">
<head>
    <title>HexGen</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="./css/styles.css" />
</head>
<body>
  <div id = 'page_content' class = 'container'>
    <div id = 'sidebar' class = 'sidebar center-text'>
            <h1 class="over-background endor">HexGen</h3>
          <h3 class = 'over-background endor'>Project Name:</h5>
          <input type="text" style = 'width:80%;height:30px;opacity:0.8;border-radius:6px;margin-top: -4rem;'></input>
          <div class = 'over-background' style="text-align:center;padding-left:20%;padding-right:20%;">
            <h4 style="display: inline;font-family:endor;">Num. Hexagons (Horizontal)</h4>
            <div class = 'row'>
              <p>3</p>
              <input id = 'number_hex_h' type="range" min="3" max="30" value="10">
              <p>30</p>
            </div>
        </div>
          <div class = 'over-background' style="text-align:center;padding-left:20%;padding-right:20%;">
            <h4 style="display: inline;font-family:endor;">Num. Hexagons (Vertical)</h4>
            <div class = 'row'>
              <p>3</p>
              <input id = 'number_hex_v' type="range" min="3" max="30" value="10">
              <p>30</p>
            </div>
        </div>
          <div id = 'make_hex' class = 'dnd-button' style="font-size: x-large;margin: 15px; padding: 10px;">Create Hex Map</div>
          <div class = 'over-background' style="text-align:center;padding-left:20%;padding-right:20%;">
            <div class = 'row'>
              <img id = 'skip_last_audio' src = 'mats/left-arrow.svg' class = 'music-button arrows'></img>
              <img id = 'start_music' src = 'mats/icons8-harp-64.png' class = 'music-button' style = 'width:35px;'></img>
              <img id = 'skip_next_audio' src = 'mats/left-arrow.svg' class = 'music-button arrows' style = 'transform: rotate(180deg);'></img>
            </div>
          </div>
    </div>
    <div id = 'main' class = 'main'>
      <!--<button class="dnd-button navbar-button" style = 'font-size: larger;margin: 10px;' onclick="showContent('char_gen_page')">Character</button>-->
      <!--<button class="dnd-button navbar-button" style = 'font-size: larger;margin: 10px' onclick="showContent('hex_gen_page')">Hex Map</button>-->
      <!-- Hex Map Page -->
      <div id = 'hex_gen_page' class = "content", style = 'display: block;'>
        <iframe id = 'hex_gen_iframe' src="hex_gen_page.html" style="width: 100%; height: 600px;background:rgba(250,250,250,.5);"></iframe>
      </div>
    </div>
  </div>
  <audio id = 'bg_music_1' src = "https://fi.zophar.net/soundfiles/nintendo-snes-spc/chrono-trigger/102%20Chrono%20Trigger%20%28Looped%29.mp3?raw=true"></audio>
  <audio id = 'bg_music_2' src = "https://vgmsite.com/soundtracks/warcraft-2-tides-of-darkness-cda/ljjizkibrg/02%20-%20Human%20Battle%2001.mp3?raw=true""></audio>
  <audio id = 'bg_music_3' src = "https://fi.zophar.net/soundfiles/nintendo-snes-spc/chrono-trigger/109%20Wind%20Scene.mp3?raw=true"></audio>
  <audio id = 'bg_music_4' src = "https://vgmsite.com/soundtracks/warcraft-2-tides-of-darkness-cda/llhafojenj/11%20-%20Orc%20Battle%2001.mp3"></audio>
  <audio id = 'bg_music_5' src = "https://fi.zophar.net/soundfiles/nintendo-snes-spc/chrono-trigger/119%20Frog%27s%20Theme.mp3?raw=true"></audio>
  <script>

    document.getElementById('page_content').style.height = window.innerHeight*0.97 + 'px';

    audio_track = 1;

    document.getElementById('start_music').addEventListener('click', function() {
      if(document.getElementById('bg_music_' + audio_track).paused){
        document.getElementById('bg_music_' + audio_track).play();
      } else {
        document.getElementById('bg_music_' + audio_track).pause();
      }
    })

    document.getElementById('skip_next_audio').addEventListener('click', function() {
      document.getElementById('bg_music_' + audio_track).pause();
      document.getElementById('bg_music_' + audio_track).currentTime = 0;
      
      audio_track = audio_track + 1;
      
      if(audio_track == 6){
        audio_track = 1;
      }
      document.getElementById('bg_music_' + audio_track).play();
    })

    document.getElementById('skip_last_audio').addEventListener('click', function() {
      document.getElementById('bg_music_' + audio_track).pause();
      document.getElementById('bg_music_' + audio_track).currentTime = 0;
      audio_track = audio_track - 1;
      
      if(audio_track == 0){
        audio_track = 5;
      }
      document.getElementById('bg_music_' + audio_track).play();
    })

  //function showContent(pageId) {
  //    // Hide all but first of content sections
  //    var contentSections = document.querySelectorAll('.content');
  //      contentSections[0].style.display = 'block';
  //    for (var i = 1; i < contentSections.length; i++) {
  //        contentSections[i].style.display = 'none';
  //    }
  //
  //    // Show the selected content section
  //    var selectedContent = document.getElementById(pageId);
  //    if (selectedContent) {
  //        selectedContent.style.display = 'block';
  //    }
  //  }

    console.log("Window up!");
    // Resize iframe on window resize.
    window.addEventListener("resize", function() {
      hex_gen_page = document.getElementById('hex_gen_page');
      hex_gen_page.style.height = window.innerHeight * 0.2 + 'px';
      //hex_gen_page.style.height = '100%';
    });

    // Send message to child pages!
    // Get a reference to the iframe
    const hex_gen_iframe = document.getElementById('hex_gen_iframe'); // Replace with your iframe ID

    // Function to send a message to the iframe
    function sendMessageToIframe() {
      const numRows = document.getElementById('number_hex_v').value; // Get input value
      const numCols = document.getElementById('number_hex_h').value; // Get input value
      container_height = document.getElementById('hex_gen_iframe').offsetHeight;
      container_width = document.getElementById('hex_gen_iframe').offsetWidth;
      //container_width = '200px';
      // Send a message to the iframe
      hex_gen_iframe.contentWindow.postMessage(
        {
          action: 'render_hex',
          numCols: numCols,
          numRows: numRows,
          container_height: container_height,
          container_width: container_width
        }//,
        //'https://localhost:8000' // Replace with the actual origin of the iframe
      );
    }

    const make_hex_button = document.getElementById('make_hex');
    make_hex_button.addEventListener('click', sendMessageToIframe);
  </script>
</body>
</html>